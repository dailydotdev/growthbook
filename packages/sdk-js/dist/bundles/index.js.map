{"version":3,"file":"index.js","sources":["../../src/util.ts","../../src/mongrule.ts","../../src/GrowthBook.ts"],"sourcesContent":["import { UrlTarget, UrlTargetType, VariationRange } from \"./types/growthbook\";\n\nfunction hashFnv32a(str: string): number {\n  let hval = 0x811c9dc5;\n  const l = str.length;\n\n  for (let i = 0; i < l; i++) {\n    hval ^= str.charCodeAt(i);\n    hval +=\n      (hval << 1) + (hval << 4) + (hval << 7) + (hval << 8) + (hval << 24);\n  }\n  return hval >>> 0;\n}\n\nexport function hash(\n  seed: string,\n  value: string,\n  version: number\n): number | null {\n  // New unbiased hashing algorithm\n  if (version === 2) {\n    return (hashFnv32a(hashFnv32a(seed + value) + \"\") % 10000) / 10000;\n  }\n  // Original biased hashing algorithm (keep for backwards compatibility)\n  if (version === 1) {\n    return (hashFnv32a(value + seed) % 1000) / 1000;\n  }\n\n  // Unknown hash version\n  return null;\n}\n\nexport function getEqualWeights(n: number): number[] {\n  if (n <= 0) return [];\n  return new Array(n).fill(1 / n);\n}\n\nexport function inRange(n: number, range: VariationRange): boolean {\n  return n >= range[0] && n < range[1];\n}\n\nexport function inNamespace(\n  hashValue: string,\n  namespace: [string, number, number]\n): boolean {\n  const n = hash(\"__\" + namespace[0], hashValue, 1);\n  if (n === null) return false;\n  return n >= namespace[1] && n < namespace[2];\n}\n\nexport function chooseVariation(n: number, ranges: VariationRange[]): number {\n  for (let i = 0; i < ranges.length; i++) {\n    if (inRange(n, ranges[i])) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function getUrlRegExp(regexString: string): RegExp | undefined {\n  try {\n    const escaped = regexString.replace(/([^\\\\])\\//g, \"$1\\\\/\");\n    return new RegExp(escaped);\n  } catch (e) {\n    console.error(e);\n    return undefined;\n  }\n}\n\nexport function isURLTargeted(url: string, targets: UrlTarget[]) {\n  if (!targets.length) return false;\n  let hasIncludeRules = false;\n  let isIncluded = false;\n\n  for (let i = 0; i < targets.length; i++) {\n    const match = _evalURLTarget(url, targets[i].type, targets[i].pattern);\n    if (targets[i].include === false) {\n      if (match) return false;\n    } else {\n      hasIncludeRules = true;\n      if (match) isIncluded = true;\n    }\n  }\n\n  return isIncluded || !hasIncludeRules;\n}\n\nfunction _evalSimpleUrlPart(\n  actual: string,\n  pattern: string,\n  isPath: boolean\n): boolean {\n  try {\n    // Escape special regex characters and change wildcard `_____` to `.*`\n    let escaped = pattern\n      .replace(/[*.+?^${}()|[\\]\\\\]/g, \"\\\\$&\")\n      .replace(/_____/g, \".*\");\n\n    if (isPath) {\n      // When matching pathname, make leading/trailing slashes optional\n      escaped = \"\\\\/?\" + escaped.replace(/(^\\/|\\/$)/g, \"\") + \"\\\\/?\";\n    }\n\n    const regex = new RegExp(\"^\" + escaped + \"$\", \"i\");\n    return regex.test(actual);\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _evalSimpleUrlTarget(actual: URL, pattern: string) {\n  try {\n    // If a protocol is missing, but a host is specified, add `https://` to the front\n    // Use \"_____\" as the wildcard since `*` is not a valid hostname in some browsers\n    const expected = new URL(\n      pattern.replace(/^([^:/?]*)\\./i, \"https://$1.\").replace(/\\*/g, \"_____\"),\n      \"https://_____\"\n    );\n\n    // Compare each part of the URL separately\n    const comps: Array<[string, string, boolean]> = [\n      [actual.host, expected.host, false],\n      [actual.pathname, expected.pathname, true],\n    ];\n    // We only want to compare hashes if it's explicitly being targeted\n    if (expected.hash) {\n      comps.push([actual.hash, expected.hash, false]);\n    }\n\n    expected.searchParams.forEach((v, k) => {\n      comps.push([actual.searchParams.get(k) || \"\", v, false]);\n    });\n\n    // If any comparisons fail, the whole thing fails\n    return !comps.some(\n      (data) => !_evalSimpleUrlPart(data[0], data[1], data[2])\n    );\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _evalURLTarget(\n  url: string,\n  type: UrlTargetType,\n  pattern: string\n): boolean {\n  try {\n    const parsed = new URL(url, \"https://_\");\n\n    if (type === \"regex\") {\n      const regex = getUrlRegExp(pattern);\n      if (!regex) return false;\n      return (\n        regex.test(parsed.href) ||\n        regex.test(parsed.href.substring(parsed.origin.length))\n      );\n    } else if (type === \"simple\") {\n      return _evalSimpleUrlTarget(parsed, pattern);\n    }\n\n    return false;\n  } catch (e) {\n    return false;\n  }\n}\n\nexport function getBucketRanges(\n  numVariations: number,\n  coverage: number | undefined,\n  weights?: number[]\n): VariationRange[] {\n  coverage = coverage === undefined ? 1 : coverage;\n\n  // Make sure coverage is within bounds\n  if (coverage < 0) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(\"Experiment.coverage must be greater than or equal to 0\");\n    }\n    coverage = 0;\n  } else if (coverage > 1) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(\"Experiment.coverage must be less than or equal to 1\");\n    }\n    coverage = 1;\n  }\n\n  // Default to equal weights if missing or invalid\n  const equal = getEqualWeights(numVariations);\n  weights = weights || equal;\n  if (weights.length !== numVariations) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(\n        \"Experiment.weights array must be the same length as Experiment.variations\"\n      );\n    }\n    weights = equal;\n  }\n\n  // If weights don't add up to 1 (or close to it), default to equal weights\n  const totalWeight = weights.reduce((w, sum) => sum + w, 0);\n  if (totalWeight < 0.99 || totalWeight > 1.01) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(\"Experiment.weights must add up to 1\");\n    }\n    weights = equal;\n  }\n\n  // Covert weights to ranges\n  let cumulative = 0;\n  return weights.map((w) => {\n    const start = cumulative;\n    cumulative += w;\n    return [start, start + (coverage as number) * w];\n  }) as VariationRange[];\n}\n\nexport function getQueryStringOverride(\n  id: string,\n  url: string,\n  numVariations: number\n) {\n  if (!url) {\n    return null;\n  }\n\n  const search = url.split(\"?\")[1];\n  if (!search) {\n    return null;\n  }\n\n  const match = search\n    .replace(/#.*/, \"\") // Get rid of anchor\n    .split(\"&\") // Split into key/value pairs\n    .map((kv) => kv.split(\"=\", 2))\n    .filter(([k]) => k === id) // Look for key that matches the experiment id\n    .map(([, v]) => parseInt(v)); // Parse the value into an integer\n\n  if (match.length > 0 && match[0] >= 0 && match[0] < numVariations)\n    return match[0];\n\n  return null;\n}\n\nexport function isIncluded(include: () => boolean) {\n  try {\n    return include();\n  } catch (e) {\n    console.error(e);\n    return false;\n  }\n}\n\nconst base64ToBuf = (b: string) =>\n  Uint8Array.from(atob(b), (c) => c.charCodeAt(0));\n\nexport async function decrypt(\n  encryptedString: string,\n  decryptionKey?: string,\n  subtle?: SubtleCrypto\n): Promise<string> {\n  decryptionKey = decryptionKey || \"\";\n  subtle = subtle || (globalThis.crypto && globalThis.crypto.subtle);\n  if (!subtle) {\n    throw new Error(\"No SubtleCrypto implementation found\");\n  }\n  try {\n    const key = await subtle.importKey(\n      \"raw\",\n      base64ToBuf(decryptionKey),\n      { name: \"AES-CBC\", length: 128 },\n      true,\n      [\"encrypt\", \"decrypt\"]\n    );\n    const [iv, cipherText] = encryptedString.split(\".\");\n    const plainTextBuffer = await subtle.decrypt(\n      { name: \"AES-CBC\", iv: base64ToBuf(iv) },\n      key,\n      base64ToBuf(cipherText)\n    );\n\n    return new TextDecoder().decode(plainTextBuffer);\n  } catch (e) {\n    throw new Error(\"Failed to decrypt\");\n  }\n}\n\nexport function paddedVersionString(input: string): string {\n  // Remove build info and leading `v` if any\n  // Split version into parts (both core version numbers and pre-release tags)\n  // \"v1.2.3-rc.1+build123\" -> [\"1\",\"2\",\"3\",\"rc\",\"1\"]\n  const parts = input.replace(/(^v|\\+.*$)/g, \"\").split(/[-.]/);\n\n  // If it's SemVer without a pre-release, add `~` to the end\n  // [\"1\",\"0\",\"0\"] -> [\"1\",\"0\",\"0\",\"~\"]\n  // \"~\" is the largest ASCII character, so this will make \"1.0.0\" greater than \"1.0.0-beta\" for example\n  if (parts.length === 3) {\n    parts.push(\"~\");\n  }\n\n  // Left pad each numeric part with spaces so string comparisons will work (\"9\">\"10\", but \" 9\"<\"10\")\n  // Then, join back together into a single string\n  return parts\n    .map((v) => (v.match(/^[0-9]+$/) ? v.padStart(5, \" \") : v))\n    .join(\"-\");\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport {\n  ConditionInterface,\n  TestedObj,\n  ConditionValue,\n  Operator,\n  OperatorConditionValue,\n  VarType,\n} from \"./types/mongrule\";\nimport { paddedVersionString } from \"./util\";\n\nconst _regexCache: { [key: string]: RegExp } = {};\n\n// The top-level condition evaluation function\nexport function evalCondition(\n  obj: TestedObj,\n  condition: ConditionInterface\n): boolean {\n  // Recursive condition\n  if (\"$or\" in condition) {\n    return evalOr(obj, condition[\"$or\"] as ConditionInterface[]);\n  }\n  if (\"$nor\" in condition) {\n    return !evalOr(obj, condition[\"$nor\"] as ConditionInterface[]);\n  }\n  if (\"$and\" in condition) {\n    return evalAnd(obj, condition[\"$and\"] as ConditionInterface[]);\n  }\n  if (\"$not\" in condition) {\n    return !evalCondition(obj, condition[\"$not\"] as ConditionInterface);\n  }\n\n  // Condition is an object, keys are object paths, values are the condition for that path\n  for (const [k, v] of Object.entries(condition)) {\n    if (!evalConditionValue(v, getPath(obj, k))) return false;\n  }\n  return true;\n}\n\n// Return value at dot-separated path of an object\nfunction getPath(obj: TestedObj, path: string) {\n  const parts = path.split(\".\");\n  let current: any = obj;\n  for (let i = 0; i < parts.length; i++) {\n    if (current && typeof current === \"object\" && parts[i] in current) {\n      current = current[parts[i]];\n    } else {\n      return null;\n    }\n  }\n  return current;\n}\n\n// Transform a regex string into a real RegExp object\nfunction getRegex(regex: string): RegExp {\n  if (!_regexCache[regex]) {\n    _regexCache[regex] = new RegExp(regex.replace(/([^\\\\])\\//g, \"$1\\\\/\"));\n  }\n  return _regexCache[regex];\n}\n\n// Evaluate a single value against a condition\nfunction evalConditionValue(condition: ConditionValue, value: any) {\n  // Simple equality comparisons\n  if (typeof condition === \"string\") {\n    return value + \"\" === condition;\n  }\n  if (typeof condition === \"number\") {\n    return value * 1 === condition;\n  }\n  if (typeof condition === \"boolean\") {\n    return !!value === condition;\n  }\n\n  if (condition === null) {\n    return value === null;\n  }\n\n  if (Array.isArray(condition) || !isOperatorObject(condition)) {\n    return JSON.stringify(value) === JSON.stringify(condition);\n  }\n\n  // This is a special operator condition and we should evaluate each one separately\n  for (const op in condition) {\n    if (\n      !evalOperatorCondition(\n        op as Operator,\n        value,\n        condition[op as keyof OperatorConditionValue]\n      )\n    ) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// If the object has only keys that start with '$'\nfunction isOperatorObject(obj: any): boolean {\n  const keys = Object.keys(obj);\n  return (\n    keys.length > 0 && keys.filter((k) => k[0] === \"$\").length === keys.length\n  );\n}\n\n// Return the data type of a value\nfunction getType(v: any): VarType | \"unknown\" {\n  if (v === null) return \"null\";\n  if (Array.isArray(v)) return \"array\";\n  const t = typeof v;\n  if ([\"string\", \"number\", \"boolean\", \"object\", \"undefined\"].includes(t)) {\n    return t as VarType;\n  }\n  return \"unknown\";\n}\n\n// At least one element of actual must match the expected condition/value\nfunction elemMatch(actual: any, expected: any) {\n  if (!Array.isArray(actual)) return false;\n  const check = isOperatorObject(expected)\n    ? (v: any) => evalConditionValue(expected, v)\n    : (v: any) => evalCondition(v, expected);\n  for (let i = 0; i < actual.length; i++) {\n    if (actual[i] && check(actual[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isIn(actual: any, expected: Array<any>): boolean {\n  // Do an intersection is attribute is an array\n  if (Array.isArray(actual)) {\n    return actual.some((el) => expected.includes(el));\n  }\n  return expected.includes(actual);\n}\n\n// Evaluate a single operator condition\nfunction evalOperatorCondition(\n  operator: Operator,\n  actual: any,\n  expected: any\n): boolean {\n  switch (operator) {\n    case \"$veq\":\n      return paddedVersionString(actual) === paddedVersionString(expected);\n    case \"$vne\":\n      return paddedVersionString(actual) !== paddedVersionString(expected);\n    case \"$vgt\":\n      return paddedVersionString(actual) > paddedVersionString(expected);\n    case \"$vgte\":\n      return paddedVersionString(actual) >= paddedVersionString(expected);\n    case \"$vlt\":\n      return paddedVersionString(actual) < paddedVersionString(expected);\n    case \"$vlte\":\n      return paddedVersionString(actual) <= paddedVersionString(expected);\n    case \"$eq\":\n      return actual === expected;\n    case \"$ne\":\n      return actual !== expected;\n    case \"$lt\":\n      return actual < expected;\n    case \"$lte\":\n      return actual <= expected;\n    case \"$gt\":\n      return actual > expected;\n    case \"$gte\":\n      return actual >= expected;\n    case \"$exists\":\n      return expected ? actual !== null : actual === null;\n    case \"$in\":\n      if (!Array.isArray(expected)) return false;\n      return isIn(actual, expected);\n    case \"$nin\":\n      if (!Array.isArray(expected)) return false;\n      return !isIn(actual, expected);\n    case \"$not\":\n      return !evalConditionValue(expected, actual);\n    case \"$size\":\n      if (!Array.isArray(actual)) return false;\n      return evalConditionValue(expected, actual.length);\n    case \"$elemMatch\":\n      return elemMatch(actual, expected);\n    case \"$all\":\n      if (!Array.isArray(actual)) return false;\n      for (let i = 0; i < expected.length; i++) {\n        let passed = false;\n        for (let j = 0; j < actual.length; j++) {\n          if (evalConditionValue(expected[i], actual[j])) {\n            passed = true;\n            break;\n          }\n        }\n        if (!passed) return false;\n      }\n      return true;\n    case \"$regex\":\n      try {\n        return getRegex(expected).test(actual);\n      } catch (e) {\n        return false;\n      }\n    case \"$type\":\n      return getType(actual) === expected;\n    default:\n      console.error(\"Unknown operator: \" + operator);\n      return false;\n  }\n}\n\n// Recursive $or rule\nfunction evalOr(obj: TestedObj, conditions: ConditionInterface[]): boolean {\n  if (!conditions.length) return true;\n  for (let i = 0; i < conditions.length; i++) {\n    if (evalCondition(obj, conditions[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// Recursive $and rule\nfunction evalAnd(obj: TestedObj, conditions: ConditionInterface[]): boolean {\n  for (let i = 0; i < conditions.length; i++) {\n    if (!evalCondition(obj, conditions[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n","import type {\n  Context,\n  Experiment,\n  FeatureResult,\n  Result,\n  SubscriptionFunction,\n  FeatureDefinition,\n  FeatureResultSource,\n  Attributes,\n  WidenPrimitives,\n  ApiHost,\n  ClientKey,\n  VariationMeta,\n  Filter,\n  VariationRange,\n} from \"./types/growthbook\";\nimport type { ConditionInterface } from \"./types/mongrule\";\nimport {\n  getUrlRegExp,\n  isIncluded,\n  getBucketRanges,\n  hash,\n  chooseVariation,\n  getQueryStringOverride,\n  inNamespace,\n  inRange,\n  isURLTargeted,\n} from \"./util\";\nimport { evalCondition } from \"./mongrule\";\n\nconst isBrowser =\n  typeof window !== \"undefined\" && typeof document !== \"undefined\";\n\nexport class GrowthBook<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  AppFeatures extends Record<string, any> = Record<string, any>\n> {\n  // context is technically private, but some tools depend on it so we can't mangle the name\n  // _ctx below is a clone of this property that we use internally\n  private context: Context;\n  public debug: boolean;\n  public ready: boolean;\n\n  // Properties and methods that start with \"_\" are mangled by Terser (saves ~150 bytes)\n  private _ctx: Context;\n  private _renderer: null | (() => void);\n  private _trackedExperiments: Set<unknown>;\n  private _trackedFeatures: Record<string, string>;\n  private _subscriptions: Set<SubscriptionFunction>;\n  private _assigned: Map<\n    string,\n    {\n      // eslint-disable-next-line\n      experiment: Experiment<any>;\n      // eslint-disable-next-line\n      result: Result<any>;\n    }\n  >;\n  // eslint-disable-next-line\n  private _forcedFeatureValues: Map<string, any>;\n  private _attributeOverrides: Attributes;\n  private _activeAutoExperiments: Map<\n    string,\n    { valueHash: string; undo: () => void }\n  >;\n\n  constructor(context?: Context) {\n    context = context || {};\n    // These properties are all initialized in the constructor instead of above\n    // This saves ~80 bytes in the final output\n    this._ctx = this.context = context;\n    this._renderer = null;\n    this._trackedExperiments = new Set();\n    this._trackedFeatures = {};\n    this.debug = false;\n    this._subscriptions = new Set();\n    this.ready = false;\n    this._assigned = new Map();\n    this._forcedFeatureValues = new Map();\n    this._attributeOverrides = {};\n    this._activeAutoExperiments = new Map();\n\n    if (context.features) {\n      this.ready = true;\n    }\n\n    if (isBrowser && context.enableDevMode) {\n      window._growthbook = this;\n      document.dispatchEvent(new Event(\"gbloaded\"));\n    }\n\n    if (context.experiments) {\n      this.ready = true;\n    }\n  }\n\n  public getApiInfo(): [ApiHost, ClientKey] {\n    return [\n      (this._ctx.apiHost || \"https://cdn.growthbook.io\").replace(/\\/*$/, \"\"),\n      this._ctx.clientKey || \"\",\n    ];\n  }\n\n  private _render() {\n    if (this._renderer) {\n      this._renderer();\n    }\n  }\n\n  public setFeatures(features: Record<string, FeatureDefinition>) {\n    this._ctx.features = features;\n    this.ready = true;\n    this._render();\n  }\n\n  public setAttributes(attributes: Attributes) {\n    this._ctx.attributes = attributes;\n    this._render();\n  }\n\n  public setAttributeOverrides(overrides: Attributes) {\n    this._attributeOverrides = overrides;\n    this._render();\n  }\n  public setForcedVariations(vars: Record<string, number>) {\n    this._ctx.forcedVariations = vars || {};\n    this._render();\n  }\n  // eslint-disable-next-line\n  public setForcedFeatures(map: Map<string, any>) {\n    this._forcedFeatureValues = map;\n    this._render();\n  }\n\n  public setURL(url: string) {\n    this._ctx.url = url;\n  }\n\n  public getAttributes() {\n    return { ...this._ctx.attributes, ...this._attributeOverrides };\n  }\n\n  public getFeatures() {\n    return this._ctx.features || {};\n  }\n\n  public getExperiments() {\n    return this._ctx.experiments || [];\n  }\n\n  public subscribe(cb: SubscriptionFunction): () => void {\n    this._subscriptions.add(cb);\n\n    return () => {\n      this._subscriptions.delete(cb);\n    };\n  }\n\n  public getAllResults() {\n    return new Map(this._assigned);\n  }\n\n  public destroy() {\n    // Release references to save memory\n    this._subscriptions.clear();\n    this._assigned.clear();\n    this._trackedExperiments.clear();\n    this._trackedFeatures = {};\n\n    if (isBrowser && window._growthbook === this) {\n      delete window._growthbook;\n    }\n\n    // Undo any active auto experiments\n    this._activeAutoExperiments.forEach((exp) => {\n      exp.undo();\n    });\n    this._activeAutoExperiments.clear();\n  }\n\n  public setRenderer(renderer: () => void) {\n    this._renderer = renderer;\n  }\n\n  public forceVariation(key: string, variation: number) {\n    this._ctx.forcedVariations = this._ctx.forcedVariations || {};\n    this._ctx.forcedVariations[key] = variation;\n    this._render();\n  }\n\n  public run<T>(experiment: Experiment<T>): Result<T> {\n    const result = this._run(experiment, null);\n    this._fireSubscriptions(experiment, result);\n    return result;\n  }\n\n  private _fireSubscriptions<T>(experiment: Experiment<T>, result: Result<T>) {\n    const key = experiment.key;\n\n    // If assigned variation has changed, fire subscriptions\n    const prev = this._assigned.get(key);\n    // TODO: what if the experiment definition has changed?\n    if (\n      !prev ||\n      prev.result.inExperiment !== result.inExperiment ||\n      prev.result.variationId !== result.variationId\n    ) {\n      this._assigned.set(key, { experiment, result });\n      this._subscriptions.forEach((cb) => {\n        try {\n          cb(experiment, result);\n        } catch (e) {\n          console.error(e);\n        }\n      });\n    }\n  }\n\n  private _trackFeatureUsage(key: string, res: FeatureResult): void {\n    // Don't track feature usage that was forced via an override\n    if (res.source === \"override\") return;\n\n    // Only track a feature once, unless the assigned value changed\n    const stringifiedValue = JSON.stringify(res.value);\n    if (this._trackedFeatures[key] === stringifiedValue) return;\n    this._trackedFeatures[key] = stringifiedValue;\n\n    // Fire user-supplied callback\n    if (this._ctx.onFeatureUsage) {\n      try {\n        this._ctx.onFeatureUsage(key, res);\n      } catch (e) {\n        // Ignore feature usage callback errors\n      }\n    }\n\n    // In browser environments, queue up feature usage to be tracked in batches\n    if (!isBrowser || !window.fetch) return;\n  }\n\n  private _getFeatureResult<T>(\n    key: string,\n    value: T,\n    source: FeatureResultSource,\n    ruleId?: string,\n    experiment?: Experiment<T>,\n    result?: Result<T>\n  ): FeatureResult<T> {\n    const ret: FeatureResult = {\n      value,\n      on: !!value,\n      off: !value,\n      source,\n      ruleId: ruleId || \"\",\n    };\n    if (experiment) ret.experiment = experiment;\n    if (result) ret.experimentResult = result;\n\n    // Track the usage of this feature in real-time\n    this._trackFeatureUsage(key, ret);\n\n    return ret;\n  }\n\n  public isOn<K extends string & keyof AppFeatures = string>(key: K): boolean {\n    return this.evalFeature(key).on;\n  }\n\n  public isOff<K extends string & keyof AppFeatures = string>(key: K): boolean {\n    return this.evalFeature(key).off;\n  }\n\n  public getFeatureValue<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(key: K, defaultValue: V): WidenPrimitives<V> {\n    const value = this.evalFeature<WidenPrimitives<V>, K>(key).value;\n    return value === null ? (defaultValue as WidenPrimitives<V>) : value;\n  }\n\n  /**\n   * @deprecated Use {@link evalFeature}\n   * @param id\n   */\n  // eslint-disable-next-line\n  public feature<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(id: K): FeatureResult<V | null> {\n    return this.evalFeature(id);\n  }\n\n  public evalFeature<\n    V extends AppFeatures[K],\n    K extends string & keyof AppFeatures = string\n  >(id: K): FeatureResult<V | null> {\n    // Global override\n    if (this._forcedFeatureValues.has(id)) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Global override\", {\n          id,\n          value: this._forcedFeatureValues.get(id),\n        });\n      return this._getFeatureResult(\n        id,\n        this._forcedFeatureValues.get(id),\n        \"override\"\n      );\n    }\n\n    // Unknown feature id\n    if (!this._ctx.features || !this._ctx.features[id]) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Unknown feature\", { id });\n      return this._getFeatureResult(id, null, \"unknownFeature\");\n    }\n\n    // Get the feature\n    const feature: FeatureDefinition<V> = this._ctx.features[id];\n\n    // Loop through the rules\n    if (feature.rules) {\n      for (const rule of feature.rules) {\n        // If it's a conditional rule, skip if the condition doesn't pass\n        if (rule.condition && !this._conditionPasses(rule.condition)) {\n          process.env.NODE_ENV !== \"production\" &&\n            this.log(\"Skip rule because of condition\", {\n              id,\n              rule,\n            });\n          continue;\n        }\n        // If there are filters for who is included (e.g. namespaces)\n        if (rule.filters && this._isFilteredOut(rule.filters)) {\n          process.env.NODE_ENV !== \"production\" &&\n            this.log(\"Skip rule because of filters\", {\n              id,\n              rule,\n            });\n          continue;\n        }\n\n        // Feature value is being forced\n        if (\"force\" in rule) {\n          // If this is a percentage rollout, skip if not included\n          if (\n            !this._isIncludedInRollout(\n              rule.seed || id,\n              rule.hashAttribute,\n              rule.range,\n              rule.coverage,\n              rule.hashVersion\n            )\n          ) {\n            process.env.NODE_ENV !== \"production\" &&\n              this.log(\"Skip rule because user not included in rollout\", {\n                id,\n                rule,\n              });\n            continue;\n          }\n\n          process.env.NODE_ENV !== \"production\" &&\n            this.log(\"Force value from rule\", {\n              id,\n              rule,\n            });\n\n          // If this was a remotely evaluated experiment, fire the tracking callbacks\n          if (rule.tracks) {\n            rule.tracks.forEach((t) => {\n              this._track(t.experiment, t.result);\n            });\n          }\n\n          return this._getFeatureResult(id, rule.force as V, \"force\", rule.id);\n        }\n        if (!rule.variations) {\n          process.env.NODE_ENV !== \"production\" &&\n            this.log(\"Skip invalid rule\", {\n              id,\n              rule,\n            });\n\n          continue;\n        }\n        // For experiment rules, run an experiment\n        const exp: Experiment<V> = {\n          variations: rule.variations as [V, V, ...V[]],\n          key: rule.key || id,\n        };\n        if (\"coverage\" in rule) exp.coverage = rule.coverage;\n        if (rule.weights) exp.weights = rule.weights;\n        if (rule.hashAttribute) exp.hashAttribute = rule.hashAttribute;\n        if (rule.namespace) exp.namespace = rule.namespace;\n        if (rule.meta) exp.meta = rule.meta;\n        if (rule.ranges) exp.ranges = rule.ranges;\n        if (rule.name) exp.name = rule.name;\n        if (rule.phase) exp.phase = rule.phase;\n        if (rule.seed) exp.seed = rule.seed;\n        if (rule.hashVersion) exp.hashVersion = rule.hashVersion;\n        if (rule.filters) exp.filters = rule.filters;\n\n        // Only return a value if the user is part of the experiment\n        const res = this._run(exp, id);\n        this._fireSubscriptions(exp, res);\n        if (res.inExperiment && !res.passthrough) {\n          return this._getFeatureResult(\n            id,\n            res.value,\n            \"experiment\",\n            rule.id,\n            exp,\n            res\n          );\n        }\n      }\n    }\n\n    process.env.NODE_ENV !== \"production\" &&\n      this.log(\"Use default value\", {\n        id,\n        value: feature.defaultValue,\n      });\n\n    // Fall back to using the default value\n    return this._getFeatureResult(\n      id,\n      feature.defaultValue === undefined ? null : feature.defaultValue,\n      \"defaultValue\"\n    );\n  }\n\n  private _isIncludedInRollout(\n    seed: string,\n    hashAttribute: string | undefined,\n    range: VariationRange | undefined,\n    coverage: number | undefined,\n    hashVersion: number | undefined\n  ): boolean {\n    if (!range && coverage === undefined) return true;\n\n    const { hashValue } = this._getHashAttribute(hashAttribute);\n    if (!hashValue) {\n      return false;\n    }\n\n    const n = hash(seed, hashValue, hashVersion || 1);\n    if (n === null) return false;\n\n    return range\n      ? inRange(n, range)\n      : coverage !== undefined\n      ? n <= coverage\n      : true;\n  }\n\n  private _conditionPasses(condition: ConditionInterface): boolean {\n    return evalCondition(this.getAttributes(), condition);\n  }\n\n  private _isFilteredOut(filters: Filter[]): boolean {\n    return filters.some((filter) => {\n      const { hashValue } = this._getHashAttribute(filter.attribute);\n      if (!hashValue) return true;\n      const n = hash(filter.seed, hashValue, filter.hashVersion || 2);\n      if (n === null) return true;\n      return !filter.ranges.some((r) => inRange(n, r));\n    });\n  }\n\n  private _run<T>(\n    experiment: Experiment<T>,\n    featureId: string | null\n  ): Result<T> {\n    const key = experiment.key;\n    const numVariations = experiment.variations.length;\n\n    // 1. If experiment has less than 2 variations, return immediately\n    if (numVariations < 2) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Invalid experiment\", { id: key });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 2. If the context is disabled, return immediately\n    if (this._ctx.enabled === false) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Context disabled\", { id: key });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 2.5. Merge in experiment overrides from the context\n    experiment = this._mergeOverrides(experiment);\n\n    // 3. If a variation is forced from a querystring, return the forced variation\n    const qsOverride = getQueryStringOverride(\n      key,\n      this._getContextUrl(),\n      numVariations\n    );\n    if (qsOverride !== null) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Force via querystring\", {\n          id: key,\n          variation: qsOverride,\n        });\n      return this._getResult(experiment, qsOverride, false, featureId);\n    }\n\n    // 4. If a variation is forced in the context, return the forced variation\n    if (this._ctx.forcedVariations && key in this._ctx.forcedVariations) {\n      const variation = this._ctx.forcedVariations[key];\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Force via dev tools\", {\n          id: key,\n          variation,\n        });\n      return this._getResult(experiment, variation, false, featureId);\n    }\n\n    // 5. Exclude if a draft experiment or not active\n    if (experiment.status === \"draft\" || experiment.active === false) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because inactive\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 6. Get the hash attribute and return if empty\n    const { hashValue } = this._getHashAttribute(experiment.hashAttribute);\n    if (!hashValue) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because missing hashAttribute\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 7. Exclude if user is filtered out (used to be called \"namespace\")\n    if (experiment.filters) {\n      if (this._isFilteredOut(experiment.filters)) {\n        process.env.NODE_ENV !== \"production\" &&\n          this.log(\"Skip because of filters\", {\n            id: key,\n          });\n        return this._getResult(experiment, -1, false, featureId);\n      }\n    } else if (\n      experiment.namespace &&\n      !inNamespace(hashValue, experiment.namespace)\n    ) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of namespace\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 7.5. Exclude if experiment.include returns false or throws\n    if (experiment.include && !isIncluded(experiment.include)) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of include function\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 8. Exclude if condition is false\n    if (experiment.condition && !this._conditionPasses(experiment.condition)) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of condition\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 8.1. Exclude if user is not in a required group\n    if (\n      experiment.groups &&\n      !this._hasGroupOverlap(experiment.groups as string[])\n    ) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of groups\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 8.2. Old style URL targeting\n    if (experiment.url && !this._urlIsValid(experiment.url as RegExp)) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of url\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 8.3. New, more powerful URL targeting\n    if (\n      experiment.urlPatterns &&\n      !isURLTargeted(this._getContextUrl(), experiment.urlPatterns)\n    ) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of url targeting\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 9. Get bucket ranges and choose variation\n    const n = hash(\n      experiment.seed || key,\n      hashValue,\n      experiment.hashVersion || 1\n    );\n    if (n === null) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of invalid hash version\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    const ranges =\n      experiment.ranges ||\n      getBucketRanges(\n        numVariations,\n        experiment.coverage === undefined ? 1 : experiment.coverage,\n        experiment.weights\n      );\n\n    const assigned = chooseVariation(n, ranges);\n\n    // 10. Return if not in experiment\n    if (assigned < 0) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because of coverage\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 11. Experiment has a forced variation\n    if (\"force\" in experiment) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Force variation\", {\n          id: key,\n          variation: experiment.force,\n        });\n      return this._getResult(\n        experiment,\n        experiment.force === undefined ? -1 : experiment.force,\n        false,\n        featureId\n      );\n    }\n\n    // 12. Exclude if in QA mode\n    if (this._ctx.qaMode) {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because QA mode\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 12.5. Exclude if experiment is stopped\n    if (experiment.status === \"stopped\") {\n      process.env.NODE_ENV !== \"production\" &&\n        this.log(\"Skip because stopped\", {\n          id: key,\n        });\n      return this._getResult(experiment, -1, false, featureId);\n    }\n\n    // 13. Build the result object\n    const result = this._getResult(experiment, assigned, true, featureId, n);\n\n    // 14. Fire the tracking callback\n    this._track(experiment, result);\n\n    // 15. Return the result\n    process.env.NODE_ENV !== \"production\" &&\n      this.log(\"In experiment\", {\n        id: key,\n        variation: result.variationId,\n      });\n    return result;\n  }\n\n  log(msg: string, ctx: Record<string, unknown>) {\n    if (!this.debug) return;\n    if (this._ctx.log) this._ctx.log(msg, ctx);\n    else console.log(msg, ctx);\n  }\n\n  private _track<T>(experiment: Experiment<T>, result: Result<T>) {\n    if (!this._ctx.trackingCallback) return;\n\n    const key = experiment.key;\n\n    // Make sure a tracking callback is only fired once per unique experiment\n    const k =\n      result.hashAttribute + result.hashValue + key + result.variationId;\n    if (this._trackedExperiments.has(k)) return;\n    this._trackedExperiments.add(k);\n\n    try {\n      this._ctx.trackingCallback(experiment, result);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  private _mergeOverrides<T>(experiment: Experiment<T>): Experiment<T> {\n    const key = experiment.key;\n    const o = this._ctx.overrides;\n    if (o && o[key]) {\n      experiment = Object.assign({}, experiment, o[key]);\n      if (typeof experiment.url === \"string\") {\n        experiment.url = getUrlRegExp(\n          // eslint-disable-next-line\n          experiment.url as any\n        );\n      }\n    }\n\n    return experiment;\n  }\n\n  private _getHashAttribute(attr?: string) {\n    const hashAttribute = attr || \"id\";\n\n    let hashValue = \"\";\n    if (this._attributeOverrides[hashAttribute]) {\n      hashValue = this._attributeOverrides[hashAttribute];\n    } else if (this._ctx.attributes) {\n      hashValue = this._ctx.attributes[hashAttribute] || \"\";\n    } else if (this._ctx.user) {\n      hashValue = this._ctx.user[hashAttribute] || \"\";\n    }\n\n    return { hashAttribute, hashValue };\n  }\n\n  private _getResult<T>(\n    experiment: Experiment<T>,\n    variationIndex: number,\n    hashUsed: boolean,\n    featureId: string | null,\n    bucket?: number\n  ): Result<T> {\n    let inExperiment = true;\n    // If assigned variation is not valid, use the baseline and mark the user as not in the experiment\n    if (variationIndex < 0 || variationIndex >= experiment.variations.length) {\n      variationIndex = 0;\n      inExperiment = false;\n    }\n\n    const { hashAttribute, hashValue } = this._getHashAttribute(\n      experiment.hashAttribute\n    );\n\n    const meta: Partial<VariationMeta> = experiment.meta\n      ? experiment.meta[variationIndex]\n      : {};\n\n    const res: Result<T> = {\n      key: meta.key || \"\" + variationIndex,\n      featureId,\n      inExperiment,\n      hashUsed,\n      variationId: variationIndex,\n      value: experiment.variations[variationIndex],\n      hashAttribute,\n      hashValue,\n    };\n\n    if (meta.name) res.name = meta.name;\n    if (bucket !== undefined) res.bucket = bucket;\n    if (meta.passthrough) res.passthrough = meta.passthrough;\n\n    return res;\n  }\n\n  private _getContextUrl() {\n    return this._ctx.url || (isBrowser ? window.location.href : \"\");\n  }\n\n  private _urlIsValid(urlRegex: RegExp): boolean {\n    const url = this._getContextUrl();\n    if (!url) return false;\n\n    const pathOnly = url.replace(/^https?:\\/\\//, \"\").replace(/^[^/]*\\//, \"/\");\n\n    if (urlRegex.test(url)) return true;\n    if (urlRegex.test(pathOnly)) return true;\n    return false;\n  }\n\n  private _hasGroupOverlap(expGroups: string[]): boolean {\n    const groups = this._ctx.groups || {};\n    for (let i = 0; i < expGroups.length; i++) {\n      if (groups[expGroups[i]]) return true;\n    }\n    return false;\n  }\n}\n"],"names":["hashFnv32a","str","hval","l","length","i","charCodeAt","hash","seed","value","version","getEqualWeights","n","Array","fill","inRange","range","inNamespace","hashValue","namespace","chooseVariation","ranges","getUrlRegExp","regexString","escaped","replace","RegExp","e","console","error","undefined","isURLTargeted","url","targets","hasIncludeRules","isIncluded","match","_evalURLTarget","type","pattern","include","_evalSimpleUrlPart","actual","isPath","regex","test","_evalSimpleUrlTarget","expected","URL","comps","host","pathname","push","searchParams","forEach","v","k","get","some","data","parsed","href","substring","origin","getBucketRanges","numVariations","coverage","weights","equal","totalWeight","reduce","w","sum","cumulative","map","start","getQueryStringOverride","id","search","split","kv","filter","parseInt","paddedVersionString","input","parts","padStart","join","_regexCache","evalCondition","obj","condition","evalOr","evalAnd","Object","entries","evalConditionValue","getPath","path","current","getRegex","isArray","isOperatorObject","JSON","stringify","op","evalOperatorCondition","keys","getType","t","includes","elemMatch","check","isIn","el","operator","passed","j","conditions","isBrowser","window","document","GrowthBook","constructor","context","_ctx","_renderer","_trackedExperiments","Set","_trackedFeatures","debug","_subscriptions","ready","_assigned","Map","_forcedFeatureValues","_attributeOverrides","_activeAutoExperiments","features","enableDevMode","_growthbook","dispatchEvent","Event","experiments","getApiInfo","apiHost","clientKey","_render","setFeatures","setAttributes","attributes","setAttributeOverrides","overrides","setForcedVariations","vars","forcedVariations","setForcedFeatures","setURL","getAttributes","getFeatures","getExperiments","subscribe","cb","add","delete","getAllResults","destroy","clear","exp","undo","setRenderer","renderer","forceVariation","key","variation","run","experiment","result","_run","_fireSubscriptions","prev","inExperiment","variationId","set","_trackFeatureUsage","res","source","stringifiedValue","onFeatureUsage","fetch","_getFeatureResult","ruleId","ret","on","off","experimentResult","isOn","evalFeature","isOff","getFeatureValue","defaultValue","feature","has","rules","rule","_conditionPasses","filters","_isFilteredOut","_isIncludedInRollout","hashAttribute","hashVersion","tracks","_track","force","variations","meta","name","phase","passthrough","_getHashAttribute","attribute","r","featureId","_getResult","enabled","_mergeOverrides","qsOverride","_getContextUrl","status","active","groups","_hasGroupOverlap","_urlIsValid","urlPatterns","assigned","qaMode","log","msg","ctx","trackingCallback","o","assign","attr","user","variationIndex","hashUsed","bucket","location","urlRegex","pathOnly","expGroups"],"mappings":"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"}